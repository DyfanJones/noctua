<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Connect to Athena using R's sdk paws — dbConnect,AthenaDriver-method • noctua</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Connect to Athena using R's sdk paws — dbConnect,AthenaDriver-method"><meta property="og:description" content="It is never advised to hard-code credentials when making a connection to Athena (even though the option is there). Instead it is advised to use
profile_name (set up by AWS Command Line Interface), 
Amazon Resource Name roles or environmental variables. Here is a list
of supported environment variables:
AWS_ACCESS_KEY_ID: is equivalent to the dbConnect parameter - aws_access_key_id
AWS_SECRET_ACCESS_KEY: is equivalent to the dbConnect parameter - aws_secret_access_key
AWS_SESSION_TOKEN: is equivalent to the dbConnect parameter - aws_session_token
AWS_ROLE_ARN: is equivalent to the dbConnect parameter - role_arn
AWS_EXPIRATION: is equivalent to the dbConnect parameter - duration_seconds
AWS_ATHENA_S3_STAGING_DIR: is equivalent to the dbConnect parameter - s3_staging_dir
AWS_ATHENA_WORK_GROUP: is equivalent to dbConnect parameter - work_group
AWS_REGION: is equivalent to dbConnect parameter - region_name


NOTE: If you have set any environmental variables in .Renviron please restart your R in order for the changes to take affect."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">noctua</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/aws_athena_query_caching.html">AWS Athena Query Caching</a>
    </li>
    <li>
      <a href="../articles/aws_athena_unload.html">AWS Athena Unload</a>
    </li>
    <li>
      <a href="../articles/aws_s3_backend.html">AWS S3 Backend</a>
    </li>
    <li>
      <a href="../articles/changing_backend_file_parser.html">Changing Backend File Parser</a>
    </li>
    <li>
      <a href="../articles/convert_and_save_cost.html">Convert and Save Cost</a>
    </li>
    <li>
      <a href="../articles/getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/how_to_retry.html">How to Retry?</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DyfanJones/noctua/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Connect to Athena using R's sdk paws</h1>
    <small class="dont-index">Source: <a href="https://github.com/DyfanJones/noctua/blob/HEAD/R/Driver.R" class="external-link"><code>R/Driver.R</code></a></small>
    <div class="hidden name"><code>dbConnect-AthenaDriver-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>It is never advised to hard-code credentials when making a connection to Athena (even though the option is there). Instead it is advised to use
<code>profile_name</code> (set up by <a href="https://aws.amazon.com/cli/" class="external-link">AWS Command Line Interface</a>), 
<a href="https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html" class="external-link">Amazon Resource Name roles</a> or environmental variables. Here is a list
of supported environment variables:</p><ul><li><p><strong>AWS_ACCESS_KEY_ID:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>aws_access_key_id</code></p></li>
<li><p><strong>AWS_SECRET_ACCESS_KEY:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>aws_secret_access_key</code></p></li>
<li><p><strong>AWS_SESSION_TOKEN:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>aws_session_token</code></p></li>
<li><p><strong>AWS_ROLE_ARN:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>role_arn</code></p></li>
<li><p><strong>AWS_EXPIRATION:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>duration_seconds</code></p></li>
<li><p><strong>AWS_ATHENA_S3_STAGING_DIR:</strong> is equivalent to the <code>dbConnect</code> parameter - <code>s3_staging_dir</code></p></li>
<li><p><strong>AWS_ATHENA_WORK_GROUP:</strong> is equivalent to <code>dbConnect</code> parameter - <code>work_group</code></p></li>
<li><p><strong>AWS_REGION:</strong> is equivalent to <code>dbConnect</code> parameter - <code>region_name</code></p></li>
</ul><p><strong>NOTE:</strong> If you have set any environmental variables in <code>.Renviron</code> please restart your R in order for the changes to take affect.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for AthenaDriver</span>
<span class="fu">dbConnect</span><span class="op">(</span>
  <span class="va">drv</span>,
  aws_access_key_id <span class="op">=</span> <span class="cn">NULL</span>,
  aws_secret_access_key <span class="op">=</span> <span class="cn">NULL</span>,
  aws_session_token <span class="op">=</span> <span class="cn">NULL</span>,
  schema_name <span class="op">=</span> <span class="st">"default"</span>,
  work_group <span class="op">=</span> <span class="cn">NULL</span>,
  poll_interval <span class="op">=</span> <span class="cn">NULL</span>,
  encryption_option <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NULL"</span>, <span class="st">"SSE_S3"</span>, <span class="st">"SSE_KMS"</span>, <span class="st">"CSE_KMS"</span><span class="op">)</span>,
  kms_key <span class="op">=</span> <span class="cn">NULL</span>,
  profile_name <span class="op">=</span> <span class="cn">NULL</span>,
  role_arn <span class="op">=</span> <span class="cn">NULL</span>,
  role_session_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"noctua-session-%s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  duration_seconds <span class="op">=</span> <span class="fl">3600L</span>,
  s3_staging_dir <span class="op">=</span> <span class="cn">NULL</span>,
  region_name <span class="op">=</span> <span class="cn">NULL</span>,
  bigint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"integer64"</span>, <span class="st">"integer"</span>, <span class="st">"numeric"</span>, <span class="st">"character"</span><span class="op">)</span>,
  binary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"raw"</span>, <span class="st">"character"</span><span class="op">)</span>,
  json <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"character"</span><span class="op">)</span>,
  timezone <span class="op">=</span> <span class="st">"UTC"</span>,
  keyboard_interrupt <span class="op">=</span> <span class="cn">TRUE</span>,
  rstudio_conn_tab <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>drv</dt>
<dd><p>an object that inherits from <a href="https://dbi.r-dbi.org/reference/DBIDriver-class.html" class="external-link">DBIDriver</a>,
or an existing <a href="https://dbi.r-dbi.org/reference/DBIConnection-class.html" class="external-link">DBIConnection</a>
object (in order to clone an existing connection).</p></dd>
<dt>aws_access_key_id</dt>
<dd><p>AWS access key ID</p></dd>
<dt>aws_secret_access_key</dt>
<dd><p>AWS secret access key</p></dd>
<dt>aws_session_token</dt>
<dd><p>AWS temporary session token</p></dd>
<dt>schema_name</dt>
<dd><p>The schema_name to which the connection belongs</p></dd>
<dt>work_group</dt>
<dd><p>The name of the <a href="https://aws.amazon.com/about-aws/whats-new/2019/02/athena_workgroups/" class="external-link">work group</a> to run Athena queries , Currently defaulted to <code>NULL</code>.</p></dd>
<dt>poll_interval</dt>
<dd><p>Amount of time took when checking query execution status. Default set to a random interval between 0.5 - 1 seconds.</p></dd>
<dt>encryption_option</dt>
<dd><p>Athena encryption at rest <a href="https://docs.aws.amazon.com/athena/latest/ug/encryption.html" class="external-link">link</a>. 
Supported Amazon S3 Encryption Options ["NULL", "SSE_S3", "SSE_KMS", "CSE_KMS"]. Connection will default to NULL,
usually changing this option is not required.</p></dd>
<dt>kms_key</dt>
<dd><p><a href="https://docs.aws.amazon.com/kms/latest/developerguide/overview.html" class="external-link">AWS Key Management Service</a>, 
please refer to <a href="https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html" class="external-link">link</a> for more information around the concept.</p></dd>
<dt>profile_name</dt>
<dd><p>The name of a profile to use. If not given, then the default profile is used.
To set profile name, the <a href="https://aws.amazon.com/cli/" class="external-link">AWS Command Line Interface</a> (AWS CLI) will need to be configured.
To configure AWS CLI please refer to: <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html" class="external-link">Configuring the AWS CLI</a>.</p></dd>
<dt>role_arn</dt>
<dd><p>The Amazon Resource Name (ARN) of the role to assume (such as <code>arn:aws:sts::123456789012:assumed-role/role_name/role_session_name</code>)</p></dd>
<dt>role_session_name</dt>
<dd><p>An identifier for the assumed role session. By default `noctua` creates a session name <code>sprintf("noctua-session-%s", as.integer(Sys.time()))</code></p></dd>
<dt>duration_seconds</dt>
<dd><p>The duration, in seconds, of the role session. The value can range from 900 seconds (15 minutes) up to the maximum session duration setting for the role. 
This setting can have a value from 1 hour to 12 hours. By default duration is set to 3600 seconds (1 hour).</p></dd>
<dt>s3_staging_dir</dt>
<dd><p>The location in Amazon S3 where your query results are stored, such as <code>s3://path/to/query/bucket/</code></p></dd>
<dt>region_name</dt>
<dd><p>Default region when creating new connections. Please refer to <a href="https://docs.aws.amazon.com/general/latest/gr/rande.html" class="external-link">link</a> for 
AWS region codes (region code example: Region = EU (Ireland)     <code> region_name = "eu-west-1"</code>)</p></dd>
<dt>bigint</dt>
<dd><p>The R type that 64-bit integer types should be mapped to,
default is [bit64::integer64], which allows the full range of 64 bit
integers.</p></dd>
<dt>binary</dt>
<dd><p>The R type that [binary/varbinary] types should be mapped to,
default is [raw]. If the mapping fails R will resort to [character] type.
To ignore data type conversion set to ["character"].</p></dd>
<dt>json</dt>
<dd><p>Attempt to converts AWS Athena data types [arrays, json] using <code>jsonlite:parse_json</code>. If the mapping fails R will resort to [character] type.
Custom Json parsers can be provide by using a function with data frame parameter.
To ignore data type conversion set to ["character"].</p></dd>
<dt>timezone</dt>
<dd><p>Sets the timezone for the connection. The default is `UTC`.
If `NULL` then no timezone is set, which defaults to the server's time zone.
`AWS Athena` accepted time zones: <a href="https://docs.aws.amazon.com/athena/latest/ug/athena-supported-time-zones.html" class="external-link">https://docs.aws.amazon.com/athena/latest/ug/athena-supported-time-zones.html</a>.</p></dd>
<dt>keyboard_interrupt</dt>
<dd><p>Stops AWS Athena process when R gets a keyboard interrupt, currently defaults to <code>TRUE</code></p></dd>
<dt>rstudio_conn_tab</dt>
<dd><p>Optional to get AWS Athena Schema and display it in RStudio's Connections Tab.
Default set to <code>TRUE</code>.</p></dd>
<dt>...</dt>
<dd><p>other parameters for <code>paws</code> session</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>dbConnect()</code> returns a s4 class. This object is used to communicate with AWS Athena.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Connect to Athena using your aws access keys</span></span>
<span class="r-in"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span class="r-in"> <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">noctua</span><span class="fu">::</span><span class="fu"><a href="athena.html">athena</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">                  aws_access_key_id<span class="op">=</span><span class="st">'YOUR_ACCESS_KEY_ID'</span>, <span class="co"># </span></span>
<span class="r-in">                  aws_secret_access_key<span class="op">=</span><span class="st">'YOUR_SECRET_ACCESS_KEY'</span>,</span>
<span class="r-in">                  s3_staging_dir<span class="op">=</span><span class="st">'s3://path/to/query/bucket/'</span>,</span>
<span class="r-in">                  region_name<span class="op">=</span><span class="st">'us-west-2'</span><span class="op">)</span></span>
<span class="r-in"> <span class="fu"><a href="dbDisconnect.html">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span class="r-in"> </span>
<span class="r-in"><span class="co"># Connect to Athena using your profile name</span></span>
<span class="r-in"><span class="co"># Profile name can be created by using AWS CLI</span></span>
<span class="r-in"> <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">noctua</span><span class="fu">::</span><span class="fu"><a href="athena.html">athena</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">                  profile_name <span class="op">=</span> <span class="st">"YOUR_PROFILE_NAME"</span>,</span>
<span class="r-in">                  s3_staging_dir <span class="op">=</span> <span class="st">'s3://path/to/query/bucket/'</span><span class="op">)</span></span>
<span class="r-in"> <span class="fu"><a href="dbDisconnect.html">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span class="r-in"> </span>
<span class="r-in"><span class="co"># Connect to Athena using ARN role</span></span>
<span class="r-in"> <span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">noctua</span><span class="fu">::</span><span class="fu"><a href="athena.html">athena</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">                  profile_name <span class="op">=</span> <span class="st">"YOUR_PROFILE_NAME"</span>,</span>
<span class="r-in">                  role_arn <span class="op">=</span> <span class="st">"arn:aws:sts::123456789012:assumed-role/role_name/role_session_name"</span>,</span>
<span class="r-in">                  s3_staging_dir <span class="op">=</span> <span class="st">'s3://path/to/query/bucket/'</span><span class="op">)</span></span>
<span class="r-in">                 </span>
<span class="r-in"> <span class="fu"><a href="dbDisconnect.html">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dyfan Jones.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

